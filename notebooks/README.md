# Исследование данных и моделей

[Анализ и препроцессинг данных](./preprocess.ipynb)

Обучение:
- [YOLO](./yolo/train_yolo.ipynb)
- [Detectron2](./Detectron2/Readme.md)
- [R-FCN](./r-fcn/rfcn-pretrained.ipynb)

## Метрики моделей

Тестирование проводилось на
- [Тестовой части предобработанного набора данных](https://disk.yandex.ru/d/PcaXzpNr3IUsRg)
- Nvidea 4090 16G
- Intel core i9 13900k

### Yolo NANO

- 0.08s / image -> 12.5 img / sec
- Map50 = 0.894
- Map50-95 = 0.656

### Yolo MAX

- 0.15s / image -> 6.7 img / sec
- Map50 = 0.923
- Map50-95 = 0.697

### Detectron2

- 0.16s / image -> 6.25 img / sec
- Map50 = 0.804
- Map50-95 = 0.699

### R-FCN

- 0.17s / image -> 5.9 img / sec
- Map50 = 0.?
- Map50-95 = 0.?

## Вывод

В нашем исследовании R-FCN показывает наилучший результат. Тем не менее, это преимущество не является значимым по ряду причин:
- По ней мало документации, отчего она сложна в поддержке и разработке.
- Работает чуть медленнее аналогов (0.17 против 0.15 у YOLO).
- Хуже масштабируется, не может обрабатывать лениво потоком и несколько фотографий сразу.

todo Дописать пару слов про детектрон

Итого наш победитель - YOLOv8 MAX. Веса доступны в этом репозитории через `git lfs`, инференс модели представлен в приложении.
