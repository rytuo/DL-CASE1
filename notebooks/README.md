# Исследование данных и моделей

[Анализ и препроцессинг данных](./preprocess.ipynb)

Обучение:
- [YOLO](./yolo/train_yolo.ipynb)
- [Detectron2](./Detectron2/Readme.md)
- [R-FCN](./r-fcn/rfcn-pretrained.ipynb)

## Метрики моделей

Тестирование проводилось на
- [Тестовой части предобработанного набора данных](https://disk.yandex.ru/d/PcaXzpNr3IUsRg)
- Nvidea 4090 16G
- Intel core i9 13900k

### Yolo NANO

- 0.08s / image -> 12.5 img / sec
- Map50 = 0.894
- Map50-95 = 0.656

### Yolo MAX

- 0.15s / image -> 6.7 img / sec
- Map50 = 0.923
- Map50-95 = 0.697

### Detectron2

- 0.16s / image -> 6.25 img / sec
- Map50 = 0.904
- Map50-95 = 0.699

### R-FCN

- 0.20s / image -> 5 img / sec
- Map50 = 0.925
- Map50-95 = 0.693

## Вывод

В нашем исследовании R-FCN показывает наилучший результат. Тем не менее, это преимущество не является достаточным для признания ее лучшей для этой задачи по ряду причин:
- По ней мало документации, отчего она сложна в поддержке и разработке.
- Работает медленнее аналогов. Это важно для детекции на большой скорости.
- Хуже масштабируется, не может обрабатывать лениво потоком и несколько фотографий сразу. В теории камер в машине может быть несколько (боковые). Хочется уметь масштабироваться в данном случае.

Детектрон показал себя хорошо с точки зрения правильного определения рамок знаков. Метрика Map50 говорит о том, сколько знаков мы вообще распознали. А Map50-95 показывает качество определения бокса для знака. Получается что модель detectron2 находит знаки на картинке чуть хуже, но при обнаружении лучше выставляет для них рамки. В нашем случае отдадим предпочтение факту детекции знака, а не качеству определения его размеров.

Между моделями YOLO мы сравнили две версии - самую большую и самую компактную. Главное их различие в соотношении качества детекции к скорости работы. Эти модели имеют идентичное api, поэтому их инференс также будет одинаковый.

Наши любительские тесты показали, что разницы между моделями почти нет. :)

Итого наш победитель - YOLOv8. Вес модели и скорость работы нужно подбирать с помощью тестов в реальных условиях.
Инференс для YOLOv8 MAX них представлен в приложении.
